dist: xenial
language: python
python:
  - "3.6"
  - "3.7"
env:
  matrix:
    - DJANGO_VERSION=2.1
    - DJANGO_VERSION=2.2
    - DJANGO_VERSION=dev
matrix:
  exclude:
    - python: 3.6
      env: DJANGO_VERSION=2.1
    - python: 3.6
      env: DJANGO_VERSION=2.2
    - python: 3.6
      env: DJANGO_VERSION=dev
    - python: 3.7
      env: DJANGO_VERSION=2.1
    - python: 3.7
      env: DJANGO_VERSION=2.2
    - python: 3.7
      env: DJANGO_VERSION=dev
install:
  - pip install -r dev-requirements.txt
  - python setup.py install
  - if [[ $DJANGO_VERSION == dev ]]; then pip
   install -e git+https://github.com/django/django@master#egg=django; else pip
   install -q Django==$DJANGO_VERSION; fi
script:
  - pip freeze
  - coverage run runtests.py
  - codecov
deploy:
  provider: pypi
  user: $PYPI_USER
  password: $PYPI_PASSWORD
  on:
    tags: true
